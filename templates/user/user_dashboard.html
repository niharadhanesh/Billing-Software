<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>User Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body {
      padding-top: 70px;
      background-color: #f8f9fa;
    }
    .navbar {
      box-shadow: 0 2px 4px rgba(0,0,0,0.08);
    }
    .navbar-nav .nav-link {
      color: #343a40 !important;
    }
    .navbar-nav .nav-link:hover {
      background-color: #e9ecef;
      border-radius: 5px;
    }
    .username-logout {
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 0.5rem;
    }
    @media (max-width: 991.98px) {
      .username-logout {
        margin-top: 1rem;
        justify-content: start;
      }
    }
    .custom-close-icon {
      font-size: 1.8rem;
      line-height: 1;
    }
    body.theme-blue {
      background-color: #cfe2ff; 
    }

    body.theme-classic {
      background-color: #f0e6ff ;
    }

    body.theme-olive {
      background-color: #d4d8b0;
    }

    body.theme-silver {
      background-color: #e2e3e5; 
    }

    body.theme-luna {
      background-color: #d9eafc ;
    }
    body.theme-win7 {
      background-color: #f4f4f4;
    }
  </style>
</head>
<body>

  <!-- Top Navbar -->
  <nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top">
    <div class="container-fluid">
      <a class="navbar-brand fw-bold" href="{% url 'userDashboard' %}" style="color: #FFAA17;">Dashboard</a>
      <button class="navbar-toggler" type="button" id="navbarToggleBtn" data-bs-toggle="collapse" data-bs-target="#navbarTop" aria-controls="navbarTop" aria-expanded="false" aria-label="Toggle navigation">
        <span id="navbarIcon" class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarTop">
        <ul class="navbar-nav flex-wrap me-auto mb-2 mb-lg-0">
          <li class="nav-item"><a class="nav-link" href="#">Invoices</a></li>
          <li class="nav-item"><a class="nav-link" href="#">Orders</a></li>
          <li class="nav-item"><a class="nav-link" href="#">Estimates</a></li>
          <li class="nav-item"><a class="nav-link" href="#">Recurring</a></li>
          <li class="nav-item"><a class="nav-link" href="#">Purchase Order</a></li>
          <li class="nav-item"><a class="nav-link" href="#">Expense</a></li>
          <li class="nav-item"><a class="nav-link" href="{% url  'customer_list' %}">Customers</a></li>
          <li class="nav-item"><a class="nav-link" href="#">Products/Services</a></li>
          <li class="nav-item"><a class="nav-link" href="#">Reports</a></li>
          <li class="nav-item"><a class="nav-link" href="{% url 'user_settings' %}">Settings</a></li>
        </ul>

        <div class="username-logout">
          <span class="text-dark"><strong>{{ user.username }}</strong></span>
          <a class="btn btn-sm" href="{% url 'LogOut' %}" style="background-color: #FFAA17; color: white;" id="logoutLink">Logout</a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="container">
    {% block content %}
      <h2 class="mt-4">Welcome to the User Dashboard</h2>
      <p class="text-muted">Use the top menu to navigate through your tasks.</p>
    {% endblock %}
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Custom JS -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const iconSpan = document.getElementById("navbarIcon");
      const collapseMenu = document.getElementById("navbarTop");

      if (!collapseMenu || !iconSpan) return;

      collapseMenu.addEventListener("shown.bs.collapse", () => {
        iconSpan.innerHTML = '&times;';
        iconSpan.classList.remove("navbar-toggler-icon");
        iconSpan.classList.add("custom-close-icon");
      });

      collapseMenu.addEventListener("hidden.bs.collapse", () => {
        iconSpan.innerHTML = '';
        iconSpan.classList.remove("custom-close-icon");
        iconSpan.classList.add("navbar-toggler-icon");
      });

      const navLinks = document.querySelectorAll(".navbar-nav .nav-link");
      navLinks.forEach(link => {
        link.addEventListener("click", () => {
          if (window.innerWidth < 992) {
            const navbarCollapse = bootstrap.Collapse.getOrCreateInstance(collapseMenu);
            navbarCollapse.hide();
          }
        });
      });
    });
  </script>

    <script>
  // On every page load: apply saved theme
  document.addEventListener("DOMContentLoaded", () => {
    const savedTheme = localStorage.getItem("dashboardTheme");
    if (savedTheme) {
      document.body.classList.add("theme-" + savedTheme);
    }
  });
</script>


<script>
  document.addEventListener("DOMContentLoaded", function () {
    const logoutLink = document.getElementById("logoutLink");

    const confirmBeforeLogout = Number("{{ confirm_logout|yesno:'1,0' }}");

    console.log("Logout link found:", logoutLink !== null);
    console.log("confirmBeforeLogout:", confirmBeforeLogout);

    if (logoutLink && confirmBeforeLogout === 1) {
      logoutLink.addEventListener("click", function (e) {
        e.preventDefault();
        if (confirm("Are you sure you want to logout?")) {
          window.location.href = logoutLink.href;
        }
      });
    }
  });
</script>


  {% block global_modals %}{% endblock %}
</body>
</html>
